{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bobing%20Corp/Desktop/bobing-ssot-new/app/finance-accounts/page.js"],"sourcesContent":["// app/finance-accounts/page.js\r\n\"use client\";\r\nimport { useState, useEffect } from 'react';\r\nimport { db } from '@/lib/firebase';\r\nimport { collection, getDocs, doc, updateDoc, deleteDoc, query, orderBy, serverTimestamp, writeBatch } from 'firebase/firestore';\r\nimport * as XLSX from 'xlsx';\r\n\r\nexport default function CoaPage() {\r\n    const [accounts, setAccounts] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => { fetchData(); }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const q = query(collection(db, \"chart_of_accounts\"), orderBy(\"code\", \"asc\"));\r\n            const snap = await getDocs(q);\r\n            const data = [];\r\n            snap.forEach(d => data.push({id: d.id, ...d.data()}));\r\n            setAccounts(data);\r\n        } catch (e) { console.error(e); } finally { setLoading(false); }\r\n    };\r\n\r\n    const toggleStatus = async (id, current) => {\r\n        try {\r\n            const newState = current === 'Aktif' ? 'Nonaktif' : 'Aktif';\r\n            await updateDoc(doc(db, \"chart_of_accounts\", id), { status: newState, updated_at: serverTimestamp() });\r\n            fetchData();\r\n        } catch (e) { alert(e.message); }\r\n    };\r\n\r\n    const deleteAccount = async (id) => {\r\n        if(confirm(\"Hapus akun ini?\")) {\r\n            await deleteDoc(doc(db, \"chart_of_accounts\", id));\r\n            fetchData();\r\n        }\r\n    };\r\n\r\n    const handleImport = (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = async (ev) => {\r\n            try {\r\n                const data = ev.target.result;\r\n                const workbook = XLSX.read(data, { type: 'array' });\r\n                const sheet = workbook.Sheets[workbook.SheetNames[0]];\r\n                const rows = XLSX.utils.sheet_to_json(sheet);\r\n\r\n                if (rows.length === 0) throw new Error(\"File kosong\");\r\n                if (!rows[0]['AccountID']) throw new Error(\"Format salah! Kolom harus: AccountID, Account Name, Account Type\");\r\n                if (!confirm(`Import ${rows.length} akun?`)) return;\r\n\r\n                const batch = writeBatch(db);\r\n                rows.forEach(row => {\r\n                    const docRef = doc(db, \"chart_of_accounts\", String(row['AccountID']));\r\n                    batch.set(docRef, {\r\n                        code: String(row['AccountID']),\r\n                        name: row['Account Name'],\r\n                        category: row['Account Type'],\r\n                        status: 'Aktif',\r\n                        updated_at: serverTimestamp()\r\n                    });\r\n                });\r\n\r\n                await batch.commit();\r\n                alert(\"Import Berhasil!\");\r\n                fetchData();\r\n            } catch (err) { alert(\"Gagal Import: \" + err.message); }\r\n            e.target.value = ''; // Reset input\r\n        };\r\n        reader.readAsArrayBuffer(file);\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8 max-w-7xl mx-auto\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-6 rounded-xl shadow-sm border border-slate-100\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-slate-800\">Chart of Accounts</h2>\r\n                    <p className=\"text-sm text-slate-500\">Daftar Akun (Aset, Kewajiban, Modal, Pendapatan, Beban).</p>\r\n                </div>\r\n                <label className=\"bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border border-emerald-200 px-4 py-2.5 rounded-lg text-sm font-bold shadow-sm transition-all flex items-center cursor-pointer\">\r\n                    <span>Import CSV / Excel</span>\r\n                    <input type=\"file\" className=\"hidden\" accept=\".csv, .xlsx\" onChange={handleImport} />\r\n                </label>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden\">\r\n                <table className=\"min-w-full divide-y divide-slate-100\">\r\n                    <thead className=\"bg-slate-50\">\r\n                        <tr>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase\">Kode</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase\">Nama Akun</th>\r\n                            <th className=\"px-6 py-4 text-left text-xs font-bold text-slate-500 uppercase\">Kategori</th>\r\n                            <th className=\"px-6 py-4 text-center text-xs font-bold text-slate-500 uppercase\">Status</th>\r\n                            <th className=\"px-6 py-4 text-right text-xs font-bold text-slate-500 uppercase\">Aksi</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody className=\"bg-white divide-y divide-slate-50\">\r\n                        {loading ? <tr><td colSpan=\"5\" className=\"text-center py-12\">Loading...</td></tr> : accounts.map(acc => {\r\n                            let catColor = 'bg-slate-100 text-slate-600';\r\n                            if (acc.category.includes('Aset')) catColor = 'bg-blue-50 text-blue-700 border-blue-100';\r\n                            if (acc.category.includes('Pendapatan')) catColor = 'bg-emerald-50 text-emerald-700 border-emerald-100';\r\n                            if (acc.category.includes('Beban')) catColor = 'bg-rose-50 text-rose-700 border-rose-100';\r\n\r\n                            return (\r\n                                <tr key={acc.id} className=\"hover:bg-slate-50\">\r\n                                    <td className=\"px-6 py-4 font-mono font-bold text-blue-600\">{acc.code}</td>\r\n                                    <td className=\"px-6 py-4 font-bold text-slate-800\">{acc.name}</td>\r\n                                    <td className=\"px-6 py-4\"><span className={`px-2.5 py-0.5 rounded-full text-[10px] font-bold uppercase border ${catColor}`}>{acc.category}</span></td>\r\n                                    <td className=\"px-6 py-4 text-center cursor-pointer\" onClick={() => toggleStatus(acc.id, acc.status)}>\r\n                                        <div className={`w-10 h-5 rounded-full relative transition-colors ${acc.status === 'Aktif' ? 'bg-emerald-500' : 'bg-slate-300'}`}>\r\n                                            <div className={`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform ${acc.status === 'Aktif' ? 'translate-x-5' : ''}`}></div>\r\n                                        </div>\r\n                                    </td>\r\n                                    <td className=\"px-6 py-4 text-right\">\r\n                                        <button onClick={() => deleteAccount(acc.id)} className=\"text-red-400 hover:text-red-600 font-bold text-xs\">Del</button>\r\n                                    </td>\r\n                                </tr>\r\n                            );\r\n                        })}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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"}}]
}