{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bobing%20Corp/Desktop/bobing-ssot-new/lib/utils.js"],"sourcesContent":["// lib/utils.js\r\nexport const formatRupiah = (n) => {\r\n  return new Intl.NumberFormat('id-ID', {\r\n    style: 'currency',\r\n    currency: 'IDR',\r\n    minimumFractionDigits: 0\r\n  }).format(n);\r\n};\r\n\r\nexport const sizeRank = ['ALL','ALL SIZE','ALLSIZE','XXXS','XXS','XS','S','M','L','XL','XXL','2XL','3XL','XXXL','4XL','5XL'];\r\n\r\nexport const sortBySize = (variantA, variantB) => {\r\n  const sizeA = (variantA.size || '').toUpperCase().trim();\r\n  const sizeB = (variantB.size || '').toUpperCase().trim();\r\n  const idxA = sizeRank.indexOf(sizeA);\r\n  const idxB = sizeRank.indexOf(sizeB);\r\n  \r\n  if (idxA !== -1 && idxB !== -1) return idxA - idxB;\r\n  if (idxA !== -1) return -1; \r\n  if (idxB !== -1) return 1;\r\n  \r\n  const colorCompare = (variantA.color || '').localeCompare(variantB.color || '');\r\n  if (colorCompare !== 0) return colorCompare;\r\n  \r\n  return (variantA.sku || '').localeCompare(variantB.sku || '');\r\n};"],"names":[],"mappings":"AAAA,eAAe;;;;;;;;;AACR,MAAM,eAAe,CAAC;IAC3B,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ;AAEO,MAAM,WAAW;IAAC;IAAM;IAAW;IAAU;IAAO;IAAM;IAAK;IAAI;IAAI;IAAI;IAAK;IAAM;IAAM;IAAM;IAAO;IAAM;CAAM;AAErH,MAAM,aAAa,CAAC,UAAU;IACnC,MAAM,QAAQ,CAAC,SAAS,IAAI,IAAI,EAAE,EAAE,WAAW,GAAG,IAAI;IACtD,MAAM,QAAQ,CAAC,SAAS,IAAI,IAAI,EAAE,EAAE,WAAW,GAAG,IAAI;IACtD,MAAM,OAAO,SAAS,OAAO,CAAC;IAC9B,MAAM,OAAO,SAAS,OAAO,CAAC;IAE9B,IAAI,SAAS,CAAC,KAAK,SAAS,CAAC,GAAG,OAAO,OAAO;IAC9C,IAAI,SAAS,CAAC,GAAG,OAAO,CAAC;IACzB,IAAI,SAAS,CAAC,GAAG,OAAO;IAExB,MAAM,eAAe,CAAC,SAAS,KAAK,IAAI,EAAE,EAAE,aAAa,CAAC,SAAS,KAAK,IAAI;IAC5E,IAAI,iBAAiB,GAAG,OAAO;IAE/B,OAAO,CAAC,SAAS,GAAG,IAAI,EAAE,EAAE,aAAa,CAAC,SAAS,GAAG,IAAI;AAC5D"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Bobing%20Corp/Desktop/bobing-ssot-new/app/finance-reports/page.js"],"sourcesContent":["// app/finance-reports/page.js\r\n\"use client\";\r\nimport { useState, useEffect } from 'react';\r\nimport { db } from '@/lib/firebase';\r\nimport { collection, getDocs, query, where } from 'firebase/firestore';\r\nimport { formatRupiah } from '@/lib/utils';\r\n\r\nexport default function ReportPLPage() {\r\n    const [data, setData] = useState({ revenue: 0, cogs: 0, expenses: 0, details: {} });\r\n    const [loading, setLoading] = useState(false);\r\n    \r\n    const now = new Date();\r\n    const firstDay = new Date(now.getFullYear(), now.getMonth(), 1).toISOString().split('T')[0];\r\n    const lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0).toISOString().split('T')[0];\r\n    \r\n    const [range, setRange] = useState({ start: firstDay, end: lastDay });\r\n\r\n    const generateReport = async () => {\r\n        setLoading(true);\r\n        const start = new Date(range.start); start.setHours(0,0,0,0);\r\n        const end = new Date(range.end); end.setHours(23,59,59,999);\r\n\r\n        try {\r\n            // 1. Revenue & COGS (From Sales)\r\n            const qSales = query(collection(db, \"sales_orders\"), where(\"order_date\", \">=\", start), where(\"order_date\", \"<=\", end));\r\n            const snapSales = await getDocs(qSales);\r\n            let rev = 0, cogs = 0;\r\n            snapSales.forEach(d => {\r\n                const s = d.data();\r\n                rev += (s.net_amount || 0);\r\n                cogs += (s.total_cost || 0);\r\n            });\r\n\r\n            // 2. Expenses (From Cash Out - Category Filter)\r\n            const qExp = query(collection(db, \"cash_transactions\"), where(\"date\", \">=\", start), where(\"date\", \"<=\", end), where(\"type\", \"==\", \"out\"));\r\n            const snapExp = await getDocs(qExp);\r\n            let expTotal = 0;\r\n            const expDet = {};\r\n            \r\n            // Exclude: pembelian (inventory asset), transfer, prive (equity draw)\r\n            const exclude = ['pembelian', 'transfer', 'prive']; \r\n            \r\n            snapExp.forEach(d => {\r\n                const t = d.data();\r\n                const cat = (t.category || 'Lainnya').toLowerCase();\r\n                if(!exclude.includes(cat)) {\r\n                    expTotal += t.amount;\r\n                    expDet[cat] = (expDet[cat] || 0) + t.amount;\r\n                }\r\n            });\r\n\r\n            setData({ revenue: rev, cogs: cogs, expenses: expTotal, details: expDet });\r\n\r\n        } catch(e) { console.error(e); } finally { setLoading(false); }\r\n    };\r\n\r\n    useEffect(() => { generateReport(); }, []);\r\n\r\n    const gross = data.revenue - data.cogs;\r\n    const net = gross - data.expenses;\r\n    const margin = data.revenue > 0 ? (net / data.revenue) * 100 : 0;\r\n\r\n    return (\r\n        <div className=\"max-w-4xl mx-auto space-y-8\">\r\n            <div className=\"flex justify-between items-center bg-white p-6 rounded-xl shadow-sm border border-slate-200\">\r\n                <div>\r\n                    <h2 className=\"text-2xl font-bold text-slate-800\">Laporan Laba Rugi</h2>\r\n                    <p className=\"text-sm text-slate-500\">Profit & Loss Statement.</p>\r\n                </div>\r\n                <div className=\"flex gap-2 items-center bg-slate-50 p-2 rounded-lg border\">\r\n                    <input type=\"date\" className=\"bg-white border rounded px-2 py-1 text-sm\" value={range.start} onChange={e=>setRange({...range, start:e.target.value})} />\r\n                    <span className=\"text-slate-400\">-</span>\r\n                    <input type=\"date\" className=\"bg-white border rounded px-2 py-1 text-sm\" value={range.end} onChange={e=>setRange({...range, end:e.target.value})} />\r\n                    <button onClick={generateReport} className=\"bg-blue-600 text-white px-4 py-1 rounded text-sm font-bold hover:bg-blue-700\">{loading ? '...' : 'Filter'}</button>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden p-8 space-y-6\">\r\n                <div>\r\n                    <h3 className=\"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 border-b pb-1\">Pendapatan</h3>\r\n                    <div className=\"flex justify-between items-center py-1\">\r\n                        <span className=\"font-medium text-slate-700\">Penjualan Bersih</span>\r\n                        <span className=\"font-bold text-lg text-slate-900\">{formatRupiah(data.revenue)}</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div>\r\n                    <h3 className=\"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 border-b pb-1\">Harga Pokok Penjualan</h3>\r\n                    <div className=\"flex justify-between items-center py-1\">\r\n                        <span className=\"font-medium text-slate-700\">COGS / HPP</span>\r\n                        <span className=\"font-bold text-lg text-red-600\">({formatRupiah(data.cogs)})</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-blue-50 p-4 rounded-lg border border-blue-100 flex justify-between items-center\">\r\n                    <span className=\"font-bold text-blue-900 uppercase\">Laba Kotor (Gross Profit)</span>\r\n                    <span className=\"font-extrabold text-xl text-blue-700\">{formatRupiah(gross)}</span>\r\n                </div>\r\n\r\n                <div>\r\n                    <h3 className=\"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 border-b pb-1\">Beban Operasional</h3>\r\n                    <div className=\"space-y-1 pl-2\">\r\n                        {Object.entries(data.details).map(([k, v]) => (\r\n                            <div key={k} className=\"flex justify-between text-sm\">\r\n                                <span className=\"capitalize text-slate-600\">{k}</span>\r\n                                <span className=\"font-mono\">{formatRupiah(v)}</span>\r\n                            </div>\r\n                        ))}\r\n                        {data.expenses === 0 && <p className=\"text-sm text-slate-400 italic\">Tidak ada beban.</p>}\r\n                    </div>\r\n                    <div className=\"flex justify-between items-center border-t mt-2 pt-2\">\r\n                        <span className=\"font-bold text-slate-700 text-sm\">Total Beban</span>\r\n                        <span className=\"font-bold text-red-600\">({formatRupiah(data.expenses)})</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-slate-900 text-white p-6 rounded-xl shadow-lg flex justify-between items-center\">\r\n                    <div>\r\n                        <span className=\"block text-slate-400 text-xs font-bold uppercase tracking-widest mb-1\">Net Profit</span>\r\n                        <span className={`text-3xl font-extrabold ${net < 0 ? 'text-red-400' : 'text-emerald-400'}`}>{formatRupiah(net)}</span>\r\n                    </div>\r\n                    <div className=\"text-right\">\r\n                        <span className=\"block text-slate-400 text-xs\">Margin</span>\r\n                        <span className=\"text-xl font-bold\">{margin.toFixed(1)}%</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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"}}]
}